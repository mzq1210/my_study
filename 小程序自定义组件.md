### 小程序视频号自定义组件

6月30日后，不允许组件自定义交易组件与视频号绑定，全部需要组件自定义交易组件【升级版】
删除订单功能：暂无



##### 二级商户号订单支付流程与原有订单支付流程有什么区别？

主要区别：二级商户号即视频号场景，订单调起支付所需参数是通过“生成支付参数”获取，无需同步支付结果；原流程调起支付是需要通过微信支付统一下单获取，需要同步支付结果。



#### 全量订单

1. 要么全量上传，都去请求shop/order/add生成订单接口，都用视频号requestOrderPayment支付，不需要带orderinfo（新版）。
2. 要么只传需要视频号支付的订单，还走小程序的逻辑，使用requestPayment支付，也不需要带orderinfo，创建售后时判断下只处理视频号支付的订单
3. 如果是全量上传，那么场景值不是视频号的订单（order.fund_type = 0）需要通过后台 api 同步订单，并在用户支付后同步支付结果，即后台order/live-sync。


建议都统一用视频号生成支付参数，不要做混合的支付，否则售后创建有问题的。新的售后创建接口必须是视频号支付的才可创建，原来支付的订单生成售后会报错（原来支付的订单不显示售后即可）



#### 下单流程
1. 调用/order/add创建订单 
2. 调用order/getpaymentparams生成支付参数
3. 使用wx.requestOrderPayment 发起支付
4. 视频号不支持0元订单，不可以发起支付哈，最低为1分



#### 支付

回调：只会下发小程序事件通知，不会通知公众号微信支付回调url 



#### 发货

视频号场景当前只支持传正常快递，不发货就不会结算，当前没有超时未发货退款逻辑，可以使用aftersale_duration限制发起售后时间，需》=5天



#### 售后

买家发起售后，商家48小时未处理会默认同意退款
新流程，卖家拒绝售后以后进纠纷流程
开通一个受控的商户号的主要原因还是合规，因为出现了大量客诉，一些使用自定义交易组件的小程序出现了收款不发货、收款跑路、售后无法处理的情况

ecaftersale/add时报47001错误请检查“product_info”字段，注意对应类型为“object”。
添加商品接口：shop/spu/add报错1040042，需要在MP后台配置微信客服/小程序客服后，然后通过“更新商家信息”接口更新商家信息



#### 结算

商户号费率为0.6%，无费率优惠，结算周期为7+7日，即用户收货后7天后结算
requestOrderPayment：如果能保证requestOrderPayment都有order_info，则可以不用场景判断，场景判断的作用是特定场景不传订单






